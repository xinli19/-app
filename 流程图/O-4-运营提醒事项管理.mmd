flowchart TD
  subgraph Create["创建提醒事项（可从弹窗场景进入）"]
    EntryPopup["从学员弹窗进入（可选）"] --> UI_New[/"运营前端 /o/reminders/new"/]
    UI_New --> FillForm["选择接收人(多选)/分类/内容/紧急度/时效(默认一周)"]
    FillForm --> Submit["提交"]
    Submit --> API_POST["POST /api/v1/reminders"]
    API_POST --> Auth{{"鉴权: 运营?"}}
    Auth -- 否 --> E403["403"]
    Auth -- 是 --> Enrich{{"若来自学员弹窗 → 自动关联 student_id；自动填充端到端类别"}}
    Enrich --> Validate{{"字段校验/接收人≥1"}}
    Validate -- 失败 --> E422["422"]
    Validate -- 通过 --> DB_Save[("DB: Reminder + Recipient 批量写入")]
    DB_Save --> Resp201["201 Created"]
  end

  subgraph ListAll["查看全部提醒事项记录列表"]
    UI_All[/"运营前端 /o/reminders/all"/] --> API_GET["GET /api/v1/reminders?sender_me=true|false&recipient_me=true|false&category?&urgency?&ordering=-created_at&q=:student"]
    API_GET --> Auth2{{"鉴权: 运营?"}}
    Auth2 -- 否 --> E403b["403"]
    Auth2 -- 是 --> DB_Query[("DB: 过滤 我发送的 ∪ 我收到的；支持分类/紧急度/时间排序/按学员检索")]
    DB_Query --> Resp200["200 items"]
    Resp200 --> Render["前端渲染 列表+分页"]
  end

  subgraph Delete["删除我发送的提醒事项"]
    ClickDelete["在列表中选择一条我发送的提醒"] --> API_DELETE["DELETE /api/v1/reminders/:id"]
    API_DELETE --> Auth3{{"鉴权: 运营?"}}
    Auth3 -- 否 --> E403c["403"]
    Auth3 -- 是 --> CheckOwner{{"校验: sender=当前运营"}}
    CheckOwner -- 否 --> E403d["403 无权限删除他人创建"]
    CheckOwner -- 是 --> DB_SoftDel[("DB: 软删 Reminder")]
    DB_SoftDel --> Resp204["204 No Content"]
  end

  Resp201 --> UI_All